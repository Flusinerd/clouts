<app-back-button
  class="absolute z-10 left-2 top-2"
  color="neutral"
  [defaultHref]="['/profile', userId]"
></app-back-button>
<div class="w-full flex justify-center relative h-36">
  <div class="flex justify-center items-center">
    <img
      class="w-full h-full object-cover"
      fill
      priority
      [ngSrc]="bannerPictureUri() || '/api/files/banners/' + userId"
    />
    <button class="image-button" (click)="takePicture('banner')">
      <img
        alt="Edit profile picture"
        ngSrc="assets/icon/edit-picture.svg"
        width="24"
        height="24"
      />
    </button>
  </div>
  <ion-avatar
    class="w-24 h-24 bottom-0 left-4 translate-y-1/2 flex justify-center items-center absolute rounded-full border-white dark:border-black border-solid border-3"
  >
    <img
      alt="Profile Picture"
      [ngSrc]="
        profilePictureUri() || '/api/files/profiles/' + userId + '?thumb=true'
      "
      fill
      priority
    />
    <button class="image-button" (click)="takePicture('profile')">
      <img
        alt="Edit profile picture"
        ngSrc="assets/icon/edit-picture.svg"
        width="24"
        height="24"
      />
    </button>
  </ion-avatar>
</div>

<form [formGroup]="form" (ngSubmit)="onSubmit()" class="mt-16">
  <div class="input-wrapper">
    <ion-item class="ion-no-padding">
      <ion-input
        type="text"
        label="Firstname"
        placeholder="John"
        labelPlacement="floating"
        required
        formControlName="firstName"
      ></ion-input>
    </ion-item>
  </div>
  <div class="input-wrapper">
    <ion-item class="ion-no-padding">
      <ion-input
        type="text"
        label="Lastname"
        placeholder="Doe"
        labelPlacement="floating"
        required
        formControlName="lastName"
      ></ion-input>
    </ion-item>
  </div>
  <div class="input-wrapper">
    <ion-item class="ion-no-padding">
      <ion-input
        type="text"
        label="Display name"
        placeholder="johndoe"
        labelPlacement="floating"
        required
        formControlName="displayName"
      ></ion-input>
    </ion-item>
  </div>
  <div class="input-wrapper">
    <ion-item class="ion-no-padding">
      <ion-textarea
        maxlength="160"
        label="Bio"
        labelPlacement="floating"
        rows="4"
        formControlName="bio"
      ></ion-textarea>
    </ion-item>
  </div>
  <div class="input-wrapper">
    <ion-item class="ion-no-padding">
      <ion-input
        label="Location"
        labelPlacement="floating"
        formControlName="location"
      ></ion-input>
    </ion-item>
  </div>
  <ion-button
    expand="block"
    class="ion-margin-top"
    type="submit"
    color="primary"
    [disabled]="!form.valid || (hasChanges$ | async) === false"
  >
    Save changes
  </ion-button>
</form>
